<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SELF//SOUND — WORLD1 (UI & Gacha)</title>
<style>
  :root{--bg:#0f1113;--card:#141617;--muted:#9aa0a6;--accent:#86a3ff;}
  body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN","Noto Sans JP","Segoe UI",Roboto,Helvetica,Arial;padding:18px;background:linear-gradient(180deg,#09090b,#0f1113);color:#e6eef8;}
  .wrap{max-width:920px;margin:0 auto;}
  h1{font-weight:600;margin:0 0 10px 0;}
  .panel{background:var(--card);border-radius:12px;padding:14px;min-height:420px;position:relative;overflow:hidden;}
  .hud{display:flex;gap:12px;align-items:center;margin-bottom:10px;}
  .stat{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;min-width:120px;text-align:center;}
  .stat .num{font-size:20px;font-weight:700;}
  .controls{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;}
  button.btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:10px;color:#e6eef8;cursor:pointer;}
  button.primary{border:1px solid rgba(255,255,255,0.12);box-shadow:0 6px 18px rgba(0,0,0,0.5);}
  .log{margin-top:12px;height:140px;overflow:auto;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:8px;border-radius:8px;font-size:13px;color:var(--muted);}
  .card{width:220px;height:120px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));display:flex;flex-direction:column;justify-content:center;align-items:center;border:2px solid rgba(255,255,255,0.03);}
  .rarity-SSR{box-shadow:0 0 22px rgba(255,215,0,0.18);border-color:rgba(255,215,0,0.35);}
  .rarity-R{border-color:rgba(150,150,255,0.12);}
  .rarity-N{border-color:rgba(200,200,200,0.06);}
  .footer-note{margin-top:8px;font-size:13px;color:var(--muted);}
  @media (max-width:640px){.wrap{padding:8px} .gacha-area{flex-direction:column}}
</style>
</head>
<body>
<div class="wrap">
  <h1>SELF//SOUND — WORLD1 (UI & Gacha)</h1>
  <div class="panel">
    <div class="hud">
      <div class="stat"><div class="small">Fans</div><div id="fans" class="num">120</div></div>
      <div class="stat"><div class="small">Money</div><div id="money" class="num">3,200</div></div>
      <div style="flex:1"></div>
      <div class="small">WORLD2: <span id="w2state">未解放</span></div>
    </div>

    <div style="display:flex;gap:12px;align-items:flex-start;">
      <div class="card" id="gachaCard"><div style="font-size:14px">-- Ready --</div></div>
      <div style="flex:1">
        <div class="controls">
          <button class="btn primary" id="pullBtn">ガチャを引く（100￥）</button>
          <button class="btn" id="pull10">×10</button>
          <button class="btn" id="openW2">WORLD2を開く（未解放）</button>
        </div>
        <div class="log" id="log">ログ：プロトタイプ (UI確認用)</div>
        <div class="footer-note">ガチャはSSR 5%（ミニプロトタイプ）。WORLD2は別ページです。</div>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  let fans=120, money=3200, world2=false;
  const $=(id)=>document.getElementById(id);

  const rarities=[
    {id:'SSR',rate:0.05,label:'深夜チル（SSR）',fans:300,money:1000},
    {id:'R',rate:0.25,label:'アンビエント（R）',fans:80,money:200},
    {id:'N',rate:0.70,label:'デモテ（N）',fans:10,money:50}
  ];
  function roll(){ let r=Math.random(), acc=0; for(let i=0;i<rarities.length;i++){ acc+=rarities[i].rate; if(r<acc) return rarities[i]; } return rarities[rarities.length-1]; }
  function update(){ $('fans').textContent=Math.floor(fans); $('money').textContent=Math.floor(money); $('w2state').textContent=world2? '解放済み':'未解放'; }
  function log(msg){ $('log').innerHTML='ログ：'+msg+'<br>'+$('log').innerHTML; }

  $('pullBtn').addEventListener('click', ()=>{
    if(money<100){ log('所持金不足'); return; }
    money-=100;
    const r=roll();
    $('gachaCard').className='card rarity-'+r.id;
    $('gachaCard').innerHTML='<div style="font-size:14px;color:#ffdca3">'+r.label+'</div><div style="font-size:12px;color:#9aa0a6">x1</div>';
    fans+=r.fans; money+=r.money;
    log(r.label+' を獲得！ Fans+'+r.fans+' ￥+'+r.money);
    if(!world2 && fans>=200){ world2=true; log('WORLD2の扉が微かに開いた…'); }
    update();
  });

  $('pull10').addEventListener('click', ()=>{
    if(money<1000){ log('所持金不足'); return; }
    for(let i=0;i<10;i++){ money-=100; const r=roll(); fans+=r.fans; money+=r.money; }
    $('gachaCard').className='card rarity-N'; $('gachaCard').innerHTML='<div style="font-size:13px">×10 引き</div>';
    log('×10 を実行しました。');
    if(!world2 && fans>=200){ world2=true; log('WORLD2の扉が微かに開いた…'); }
    update();
  });

  $('openW2').addEventListener('click', ()=>{
    if(!world2){ log('WORLD2はまだ未解放です。ファンを増やしてみて。'); return; }
    // try to open world2 page relative to current file name
    const next = window.location.href.replace(/[^/]*$/, 'world2_only.html');
    window.location.href = next;
  });

  update();
  // save/load
  try{
    const s=localStorage.getItem('selfsound_world1');
    if(s){ const st=JSON.parse(s); fans=st.fans||fans; money=st.money||money; world2=st.world2||world2; update(); }
  }catch(e){}
  setInterval(()=>{ localStorage.setItem('selfsound_world1', JSON.stringify({fans,money,world2})); },1500);
})();
</script>
</body>
</html>
